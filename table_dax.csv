nameMeasure,expressionMeasure,table_name_in_DAX,column_name_in_DAX
Total customers,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 )",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Total customers,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 )",Dim_Date,Date
Total customers,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 )",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cust. Classic,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Cust. Classic,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max1)",Dim_Date,Date
Cust. Classic,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cust. Classic,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,SEGMENTS
Cust. Emerald,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Cust. Emerald,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max1)",Dim_Date,Date
Cust. Emerald,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cust. Emerald,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,SEGMENTS
Cust. Sapphire,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Cust. Sapphire,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max1)",Dim_Date,Date
Cust. Sapphire,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cust. Sapphire,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,SEGMENTS
Cust. Ruby,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Cust. Ruby,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max1)",Dim_Date,Date
Cust. Ruby,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cust. Ruby,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,SEGMENTS
Cust. Diamond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Cust. Diamond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max1)",Dim_Date,Date
Cust. Diamond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cust. Diamond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max1)",CIF_AUM_PRODUCT_PENE,SEGMENTS
Header,"//  ""07/02/2023""FORMAT( MAX( CIF_AUM_PRODUCT_PENE[REPORT_DATE]) , ""DD/MM/YYYY"" )",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment CA,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CA] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment CA,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CA] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment CA,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CA] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment CA,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CA] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% Customer by segment,"Var _Segment1 = SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])return   SWITCH(true(),        1=1 , CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] = _Segment1)/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), ALL( CIF_AUM_PRODUCT_PENE[SEGMENTS]) ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% Customer by segment,"Var _Segment1 = SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])return   SWITCH(true(),        1=1 , CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] = _Segment1)/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), ALL( CIF_AUM_PRODUCT_PENE[SEGMENTS]) ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
AVG product_total,"CALCULATE([Product CA] + [Product TD] + [Product CC] + [Product DB] + [Product Loan] + [Product Banca] + [Product Bond] + [Product EB])/ CALCULATE([Total customers], CIF_AUM_PRODUCT_PENE[ACTIVE_PRODUCT] =""Y"")",CIF_AUM_PRODUCT_PENE,ACTIVE_PRODUCT
avg pproduct_Diamond,"CALCULATE([Product CA] + [Product TD] + [Product CC] + [Product DB] + [Product Loan] + [Product Banca] + [Product Bond] + [Product EB], CIF_AUM_PRODUCT_PENE[SEGMENTS]=""5.Diamond"") / [Cust. Diamond]",CIF_AUM_PRODUCT_PENE,SEGMENTS
avg pproduct_Emerald,"CALCULATE([Product CA] + [Product TD] + [Product CC] + [Product DB] + [Product Loan] + [Product Banca] + [Product Bond] + [Product EB], CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"")/ [Cust. Emerald]",CIF_AUM_PRODUCT_PENE,SEGMENTS
avg pproduct_Ruby,"CALCULATE([Product CA] + [Product TD] + [Product CC] + [Product DB] + [Product Loan] + [Product Banca] + [Product Bond] + [Product EB], CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"") / [Cust. Ruby]",CIF_AUM_PRODUCT_PENE,SEGMENTS
avg pproduct_Sapphire,"CALCULATE([Product CA] + [Product TD] + [Product CC] + [Product DB] + [Product Loan] + [Product Banca] + [Product Bond] + [Product EB], CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"")/ [Cust. Sapphire]",CIF_AUM_PRODUCT_PENE,SEGMENTS
avg pproduct_Classic,"CALCULATE([Product CA] + [Product TD] + [Product CC] + [Product DB] + [Product Loan] + [Product Banca] + [Product Bond] + [Product EB], CIF_AUM_PRODUCT_PENE[SEGMENTS]=""1.Classic"") / [Cust. Classic]",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Balance CASA_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",Dim_Date,Date
Balance CASA_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,CASA
Balance CASA_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Balance CASA_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",Dim_Date,Date
Balance CASA_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,CASA
Balance CASA_Emerald," var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Balance CASA_Emerald," var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",Dim_Date,Date
Balance CASA_Emerald," var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Emerald," var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,CASA
Balance CASA_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Balance CASA_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",Dim_Date,Date
Balance CASA_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,CASA
Balance CASA_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Balance CASA_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",Dim_Date,Date
Balance CASA_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,CASA
Balance CASA_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Balance CASA_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",Dim_Date,Date
Balance CASA_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Balance CASA_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[CASA]), ALL(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,CASA
TD balance_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD balance_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",Dim_Date,Date
TD balance_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_BAL
TD balance_Classic,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""1.Classic"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TD balance_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD balance_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",Dim_Date,Date
TD balance_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_BAL
TD balance_Diamond,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""5.Diamond"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TD balance_Emerald,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD balance_Emerald,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",Dim_Date,Date
TD balance_Emerald,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_BAL
TD balance_Emerald,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""2.Emerald"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TD balance_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD balance_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",Dim_Date,Date
TD balance_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_BAL
TD balance_Ruby,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""4.Ruby"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TD balance_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD balance_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",Dim_Date,Date
TD balance_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_BAL
TD balance_Sapphire,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), CIF_AUM_PRODUCT_PENE[SEGMENTS] =""3.Sapphire"", Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TD balance_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD balance_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",Dim_Date,Date
TD balance_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_BAL
TD balance_Total,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_BAL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
MOM total,"Var _max = max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return [Total customers]/CALCULATE([Total customers], DATEADD(Dim_Date[Date], -1, MONTH)) -1",CIF_AUM_PRODUCT_PENE,REPORT_DATE
MOM total,"Var _max = max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return [Total customers]/CALCULATE([Total customers], DATEADD(Dim_Date[Date], -1, MONTH)) -1",Dim_Date,Date
MOM total,"Var _max = max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return [Total customers]/CALCULATE([Total customers], DATEADD(Dim_Date[Date], -1, MONTH)) -1",return,Total customers
MOM classic,"[Cust. Classic]/CALCULATE([Cust. Classic], DATEADD(Dim_Date[Date], -1, MONTH)) -1",Dim_Date,Date
MOM Emerald,"[Cust. Emerald]/CALCULATE([Cust. Emerald], DATEADD(Dim_Date[Date], -1, MONTH)) -1",Dim_Date,Date
YOY Total,"[Total customers]/ CALCULATE([Total customers], DATEADD(Dim_Date[Date], -1, year ) ) - 1",Dim_Date,Date
MOM Sapphire,"[Cust. Sapphire]/CALCULATE([Cust. Sapphire], DATEADD(Dim_Date[Date], -1, MONTH)) -1",Dim_Date,Date
MOM Ruby,"[Cust. Ruby]/CALCULATE([Cust. Ruby], DATEADD(Dim_Date[Date], -1, MONTH)) -1",Dim_Date,Date
MOM Diamond,"[Cust. Diamond]/CALCULATE([Cust. Diamond], DATEADD(Dim_Date[Date], -1, MONTH)) -1",Dim_Date,Date
Product CA,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ),filter(CIF_AUM_PRODUCT_PENE,[CA] = ""Yes""), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product CA,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ),filter(CIF_AUM_PRODUCT_PENE,[CA] = ""Yes""), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product CA,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ),filter(CIF_AUM_PRODUCT_PENE,[CA] = ""Yes""), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product TD,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [TD] = ""Yes"" ), Dim_Date[Date] = _max1 )",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product TD,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [TD] = ""Yes"" ), Dim_Date[Date] = _max1 )",Dim_Date,Date
Product TD,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [TD] = ""Yes"" ), Dim_Date[Date] = _max1 )",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product CC,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [CC] =""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product CC,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [CC] =""Yes"" ), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product CC,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [CC] =""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product DB,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE , [DB] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product DB,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE , [DB] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product DB,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE , [DB] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product Loan,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [LOAN] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product Loan,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [LOAN] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product Loan,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE, [LOAN] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product Banca,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), FILTER(CIF_AUM_PRODUCT_PENE, [BANCA] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product Banca,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), FILTER(CIF_AUM_PRODUCT_PENE, [BANCA] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product Banca,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), FILTER(CIF_AUM_PRODUCT_PENE, [BANCA] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product Bond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter(CIF_AUM_PRODUCT_PENE, [BOND] = ""Yes""), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product Bond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter(CIF_AUM_PRODUCT_PENE, [BOND] = ""Yes""), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product Bond,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter(CIF_AUM_PRODUCT_PENE, [BOND] = ""Yes""), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Product EB,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE , [EB] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product EB,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE , [EB] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product EB,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter (CIF_AUM_PRODUCT_PENE , [EB] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment TD,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product TD] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment TD,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product TD] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment TD,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product TD] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment TD,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product TD] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% product /segment CC,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CC] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment CC,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CC] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment CC,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CC] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment CC,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product CC] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% product /segment DB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product DB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment DB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product DB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment DB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product DB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment DB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product DB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% product /segment Loan,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Loan] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment Loan,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Loan] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment Loan,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Loan] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment Loan,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Loan] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% product /segment Banca,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Banca] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment Banca,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Banca] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment Banca,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Banca] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment Banca,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Banca] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% product /segment Bond,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Bond] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment Bond,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Bond] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment Bond,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Bond] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment Bond,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Bond] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
% product /segment EB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product EB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment EB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product EB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment EB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product EB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment EB,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product EB] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
test 2,"CALCULATE( [Total customers], DATESINPERIOD(        Dim_Date[Date],        MAX( Dim_Date[Date]),        -500,        MONTH))",Dim_Date,Date
% Customer by segment_Classic,"CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] = ""1.Classic"")/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), ALL( CIF_AUM_PRODUCT_PENE[SEGMENTS]))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% Customer by segment_Classic,"CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[SEGMENTS] = ""1.Classic"")/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), ALL( CIF_AUM_PRODUCT_PENE[SEGMENTS]))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TEST3,"CALCULATE( [test 2], SAMEPERIODLASTYEAR( (Dim_Date[Date]) ))",Dim_Date,Date
YOY Classic,"[Cust. Classic] / CALCULATE( [Cust. Classic], DATEADD(Dim_Date[Date], -1, year ) ) - 1",Dim_Date,Date
YOY Emmeral,"[Cust. Emerald] / CALCULATE( [Cust. Emerald] , DATEADD(Dim_Date[Date], -1, year ) ) - 1",Dim_Date,Date
YOY Sapphire,"[Cust. Sapphire] / CALCULATE( [Cust. Sapphire] , DATEADD(Dim_Date[Date], -1, year ) ) - 1",Dim_Date,Date
YOY Ruby,"[Cust. Ruby] / CALCULATE( [Cust. Ruby], DATEADD(Dim_Date[Date], -1, year ) ) - 1",Dim_Date,Date
YOY Diamond,"[Cust. Diamond] / CALCULATE( [Cust. Diamond], DATEADD(Dim_Date[Date], -1, year ) ) - 1",Dim_Date,Date
TD Online,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
TD Online,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",Dim_Date,Date
TD Online,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
TD Online,"var _max = max(CIF_AUM_PRODUCT_PENE[REPORT_DATE])var _EOM = max(Dim_Date[Date] )return     switch(true(),        _EOM < _max, CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _EOM ),        CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[TD_ONL]), all(CIF_AUM_PRODUCT_PENE[SEGMENTS]), Dim_Date[Date] = _max ))",CIF_AUM_PRODUCT_PENE,TD_ONL
Cif only,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 , CIF_AUM_PRODUCT_PENE[ACTIVE_PRODUCT] =""N"")",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Cif only,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 , CIF_AUM_PRODUCT_PENE[ACTIVE_PRODUCT] =""N"")",Dim_Date,Date
Cif only,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 , CIF_AUM_PRODUCT_PENE[ACTIVE_PRODUCT] =""N"")",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Cif only,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] = _max1 , CIF_AUM_PRODUCT_PENE[ACTIVE_PRODUCT] =""N"")",CIF_AUM_PRODUCT_PENE,ACTIVE_PRODUCT
Product Skyjoy,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter(CIF_AUM_PRODUCT_PENE,[SKYJOY] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,REPORT_DATE
Product Skyjoy,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter(CIF_AUM_PRODUCT_PENE,[SKYJOY] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",Dim_Date,Date
Product Skyjoy,"var _max1= max (CIF_AUM_PRODUCT_PENE[REPORT_DATE])return CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST] ), filter(CIF_AUM_PRODUCT_PENE,[SKYJOY] = ""Yes"" ), Dim_Date[Date] = _max1 ) ",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment Skyjoy,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Skyjoy] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,REPORT_DATE
% product /segment Skyjoy,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Skyjoy] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",Dim_Date,Date
% product /segment Skyjoy,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Skyjoy] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
% product /segment Skyjoy,"Var _Segment= SELECTEDVALUE(CIF_AUM_PRODUCT_PENE[SEGMENTS])var _max1 = max( CIF_AUM_PRODUCT_PENE[REPORT_DATE])return     switch(true(),        1=1, [Product Skyjoy] / CALCULATE(SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), Dim_Date[Date] =_max1 ))",CIF_AUM_PRODUCT_PENE,SEGMENTS
Bill CNT/ cust,"SUM(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CNT])/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Bill CNT/ cust,"SUM(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CNT])/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,BILL_PAYMENT_CUST
Bill CNT/ cust,"SUM(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CNT])/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,BILL_PAYMENT_CNT
Bill AMT/ cust,"SUM(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_AMT])/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Bill AMT/ cust,"SUM(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_AMT])/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,BILL_PAYMENT_CUST
Bill AMT/ cust,"SUM(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_AMT])/ CALCULATE(sum(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,BILL_PAYMENT_AMT
Bill Amt total,sum(CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_AMT] ),CIF_AUM_PRODUCT_PENE,BILL_PAYMENT_AMT
Bill Cust,"CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,NUMBER_CUST
Bill Cust,"CALCULATE( SUM(CIF_AUM_PRODUCT_PENE[NUMBER_CUST]), CIF_AUM_PRODUCT_PENE[BILL_PAYMENT_CUST] = 1)",CIF_AUM_PRODUCT_PENE,BILL_PAYMENT_CUST
